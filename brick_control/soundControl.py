from time import sleep
import nxt.locator


class SoundControl(object):
	def __init__(self, brick):
		self.brick = brick

		# C5, D5, ...
		# https://en.wikipedia.org/wiki/Piano_key_frequencies
		self.freq = {
			'B0' : 31,
			'C1' : 33,
			'CS1' : 35,
			'D1' : 37,
			'DS1' : 39,
			'E1' : 41,
			'F1' : 44,
			'FS1' : 46,
			'G1' : 49,
			'GS1' : 52,
			'A1' : 55,
			'AS1' : 58,
			'B1' : 62,
			'C2' : 65,
			'CS2' : 69,
			'D2' : 73,
			'DS2' : 78,
			'E2' : 82,
			'F2' : 87,
			'FS2' : 93,
			'G2' : 98,
			'GS2' : 104,
			'A2' : 110,
			'AS2' : 117,
			'B2' : 123,
			'C3' : 131,
			'CS3' : 139,
			'D3' : 147,
			'DS3' : 156,
			'E3' : 165,
			'F3' : 175,
			'FS3' : 185,
			'G3' : 196,
			'GS3' : 208,
			'A3' : 220,
			'AS3' : 233,
			'B3' : 247,
			'C4' : 262,
			'CS4' : 277,
			'D4' : 294,
			'DS4' : 311,
			'E4' : 330,
			'F4' : 349,
			'FS4' : 370,
			'G4' : 392,
			'GS4' : 415,
			'A4' : 440,
			'AS4' : 466,
			'B4' : 494,
			'C5' : 523,
			'CS5' : 554,
			'D5' : 587,
			'DS5' : 622,
			'E5' : 659,
			'F5' : 698,
			'FS5' : 740,
			'G5' : 784,
			'GS5' : 831,
			'A5' : 880,
			'AS5' : 932,
			'B5' : 988,
			'C6' : 1047,
			'CS6' : 1109,
			'D6' : 1175,
			'DS6' : 1245,
			'E6' : 1319,
			'F6' : 1397,
			'FS6' : 1480,
			'G6' : 1568,
			'GS6' : 1661,
			'A6' : 1760,
			'AS6' : 1865,
			'B6' : 1976,
			'C7' : 2093,
			'CS7' : 2217,
			'D7' : 2349,
			'DS7' : 2489,
			'E7' : 2637,
			'F7' : 2794,
			'FS7' : 2960,
			'G7' : 3136,
			'GS7' : 3322,
			'A7' : 3520,
			'AS7' : 3729,
			'B7' : 3951,
			'C8' : 4186,
			'CS8' : 4435,
			'D8' : 4699,
			'DS8' : 4978,
			'R' : None
		}


	def playMary(self):
		song = ['E5', 'D5', 'C5', 'D5', 'E5', 'E5', 'E5', 'R', 'D5', 'D5', 'D5', 'R', 'E5', 'G5', 'G5', 'R', 'E5', 'D5', 'C5', 'D5', 'E5', 'E5', 'E5', 'E5', 'D5', 'D5', 'E5', 'D5', 'C5']
		self.playSong(song)

	def playGot(self):
		song = ['C4','DS4','F4','C4','DS4','F4','C4','DS4','F4','C4','DS4','F4','C4','E4','F4','C4','E4','F4','C4','E4','F4','C4','E4','F4','G4','C4','DS4','F4','D4','AS3','C4','D4','AS3','C4','D4','AS3','C4','D4','G3','AS3','C4','D4','F4','AS3','DS4','D4','F4','AS3','DS4','D4','C4','GS3','AS3','C4','F3','GS3','AS3','C4','F3','GS3','AS3','C4','F3','G4','C4','DS4','F4','G4','C4','DS4','F4','D4','G3','AS3','C4','D4','G3','AS3','C4','D4','G3','AS3','C4','D4']
		self.playSong(song)

	def playSuperMario(self):
		song = ['E7', 'E7', 'R', 'E7', 'R', 'C7', 'E7', 'R', 'G7', 'R', 'R', 'R', 'G6', 'R', 'R', 'R', 'C7', 'R', 'R', 'G6', 'R', 'R', 'E6', 'R', 'R', 'A6', 'R', 'B6', 'R', 'AS6', 'A6', 'R', 'G6', 'E7', 'G7', 'A7', 'R', 'F7', 'G7', 'R', 'E7', 'R', 'C7', 'D7', 'B6', 'R', 'R', 'C7', 'R', 'R', 'G6', 'R', 'R', 'E6', 'R', 'R', 'A6', 'R', 'B6', 'R', 'AS6', 'A6', 'R', 'G6', 'E7', 'G7', 'A7', 'R', 'F7', 'G7', 'R', 'E7', 'R', 'C7', 'D7', 'B6', 'R', 'R']
		tempo = [12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 9, 9, 9, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 9, 9, 9, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12]
		tempo = [x/1.8 for x in tempo]
		self.playSong(song, tempo)


	def playSuperMarioUnderworld(self):
		song = ['C4', 'C5', 'A3', 'A4', 'AS3', 'AS4', 'R', 'R', 'C4', 'C5', 'A3', 'A4', 'AS3', 'AS4', 'R', 'R', 'F3', 'F4', 'D3', 'D4', 'DS3', 'DS4', 'R', 'R', 'F3', 'F4', 'D3', 'D4', 'DS3', 'DS4', 'R', 'R', 'DS4', 'CS4', 'D4', 'CS4', 'DS4', 'DS4', 'GS3', 'G3', 'CS4', 'C4', 'FS4', 'F4', 'E3', 'AS4', 'A4', 'GS4', 'DS4', 'B3', 'AS3', 'A3', 'GS3', 'R', 'R', 'R']
		tempo = [12, 12, 12, 12, 12, 12, 6, 3, 12, 12, 12, 12, 12, 12, 6, 3, 12, 12, 12, 12, 12, 12, 6, 3, 12, 12, 12, 12, 12, 12, 6, 6, 18, 18, 18, 6, 6, 6, 6, 6, 6, 18, 18, 18, 18, 18, 18, 10, 10, 10, 10, 10, 10, 3, 3, 3]
		tempo = [x/1.8 for x in tempo]
		self.playSong(song, tempo)

	def playYMCA(self):
		song = ['C4','E4','B4','A4','C4','E4','D2','D2','D2','D2','D3','B4','A4','D5','B4','B4','A4','E4','A4','D2','D3','C4','E4','B4','A4','C4','E4','D2','D2','D2','D2','D3','B4','A4','D5','B4','B4','A4','E4','A4','D2','D3','C4','D4','G4','C4','D4','G4','C4','D4','G4','C4','D4','G4','C4','D4','G4','C4','D4','G4','D2','D2','D2','D2','C4','D4','G4','D2','D2','D2','D3','D2','D3','D5','G4','B4','B4','A4','G2','G2','G2','G2','G4','A4','B4','G4','B4','D5','B4','D5','G2','G2','G2','G2','E5','G4','B4','B4','A4','E2','E2','E2','E2','G4','A4','B4','G4','B4','D5','B4','D5','E2','E2','B1','B1','E5','G4','C5','C5','B4','C2','C2','C2','C2','A4','B4','C5','A4','C5','E5','G5','C5','E5','C2','C2','C3','C3','A4','D5','G4','C5','E5','A4','D5','E3','D3','A4','D5','E4','G4','C5','D4','G4','B4','D4','A4','D3','C3','B2','A2','D5','G4','B4','B4','A4','G2','G2','G2','G2','G4','A4','B4','G4','B4','D5','B4','D5','G2','G2','G2','G2','E5','G4','B4','B4','A4','E2','E2','E2','E2','G4','A4','B4','G4','B4','D5','B4','D5','E2','E2','B1','B1','E5','G4','C5','C5','B4','C2','C2','C2','C2','A4','B4','C5','A4','C5','E5','G5','C5','E5','C2','C2','C3','C3','A4','D5','G4','C5','E5','A4','D5','E3','D3','A4','D5','E4','G4','C5','D4','G4','B4','D4','A4','D3','C3','B2','A2','A4','C5','D5','A4','C5','D5','A4','C5','D5','A4','C5','D5','D3','D3','D3','D3','A4','C5','D5','B4','D5','B4','D5','B4','D5','D2','G4','B4','E5','D5','E5','G4','B4','D5','G2','G3','G3','G2','G3','B4','D5','B4','D5','B4','A4','G4','G2','G2','D2','D4','A4','G4','B4','A4','G4','E2','E3','E3','E2','E3','G4','B3','E4','G5','E5','E2','E2','G2','C5','G5','G5','G5','E5','G5','E5','A2','A2','A2','A2','C5','G5','G5','G5','G4','E5','G5','E5','A2','A2','A2','A2','G5','E5','D5','C5','E5','G5','G5','C5','E5','D3','D3','D2','D2','C5','E5','G4','G4','E4','G4','E4','G4','D3','D3','D2','B3','E4','D4','E4','B3','D4','G2','G2','G2','G2','G2','G4','G4','E4','B3','D4','G4','G4','G4','G2','G2','G2','G2','B3','E4','G4','G4','E4','G4','E2','E3','E3','E2','E3','G4','B3','E4','G4','E4','E2','E2','G2','C4','G4','G4','G4','E4','G4','E4','A2','A2','A2','A2','C4','G4','G4','G4','G3','E4','G4','E4','A2','A2','A2','A2','C4','G4','E4','D4','C4','E4','G4','G4','E4','D3','D3','D2','D2','D4','D3','D3','D2','D3','D2','D3','G4','B4','E5','D5','E5','G4','B4','D5','G2','G3','G3','G2','G3','B4','D5','B4','D5','B4','A4','G4','G2','G2','D2','D4','A4','G4','B4','A4','G4','E2','E3','E3','E2','E3','G4','B3','E4','G5','E5','E2','E2','G2','C5','G5','G5','G5','E5','G5','E5','A2','A2','A2','A2','C5','G5','G5','G5','G4','E5','G5','E5','A2','A2','A2','A2','G5','E5','D5','C5','E5','G5','G5','C5','E5','D3','D3','D2','D2','C5','E5','G5','G5','E5','G5','E5','G5','D3','D3','D2','C5','E5','G5','G5','E5','G5','E5','G5','D3','D3','D2','B4','D5','G5','G2','G3']
		duration = [2,2,2,4,2,8,8,16,4,4,4,2,2,2,2,2,1,2,1,2,2,2,16,16,16,6,6,6,2,8,8,16,4,4,4,2,2,2,2,2,1,2,1,2,2,2,16,16,16,6,6,6,1,1,1,1,1,1,6,6,6,1,1,1,1,1,1,16,4,4,4,4,16,16,16,16,4,4,2,2,2,2,2,2,2,8,2,2,16,4,4,4,4,2,2,2,4,4,4,2,4,16,4,4,4,4,2,2,2,8,2,2,16,4,4,4,4,2,2,2,4,4,4,2,4,16,4,4,4,4,2,2,2,8,2,2,16,4,4,4,4,2,2,2,4,4,4,2,4,4,16,4,4,4,4,6,6,6,6,6,6,4,4,4,16,6,6,4,2,2,2,6,6,6,4,4,4,4,4,4,16,2,6,4,4,2,2,2,8,2,2,16,4,4,4,4,2,2,2,4,4,4,2,4,16,4,4,4,4,2,2,2,8,2,2,16,4,4,4,4,2,2,2,4,4,4,2,4,16,4,4,4,4,2,2,2,8,2,2,16,4,4,4,4,2,2,2,4,4,4,2,4,4,16,4,4,4,4,6,6,6,6,6,6,4,4,4,16,6,6,4,2,2,2,6,6,6,4,4,4,4,4,4,16,2,6,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,16,4,4,4,4,2,2,2,2,2,2,2,2,2,4,16,2,2,4,8,8,8,8,4,2,2,2,2,16,4,2,2,4,4,2,2,2,2,2,2,2,2,16,4,4,4,4,8,8,4,4,2,2,16,4,2,2,4,4,2,6,6,4,2,2,16,4,4,4,4,2,2,2,2,6,6,2,2,16,4,4,4,4,2,2,2,2,6,6,2,2,16,4,4,4,4,2,2,2,4,4,4,4,2,2,16,4,4,4,4,2,2,2,2,2,2,2,4,16,4,4,4,4,8,8,4,2,2,2,16,4,2,2,4,4,2,2,2,2,2,2,2,2,4,16,4,4,4,4,8,8,8,4,2,2,16,4,2,2,4,4,2,6,6,4,2,2,16,4,4,4,4,2,2,2,2,6,6,2,2,16,4,4,4,4,2,2,2,2,6,6,2,2,16,4,4,4,4,2,2,2,2,4,4,4,4,2,16,4,4,4,4,8,8,16,4,4,2,2,2,2,8,8,8,4,2,2,2,2,16,4,2,2,4,4,2,2,2,2,2,2,2,2,16,4,4,4,4,8,8,4,4,2,2,16,4,2,2,4,4,2,6,6,4,2,2,16,4,4,4,4,2,2,2,2,6,6,2,2,16,4,4,4,4,2,2,2,2,6,6,2,2,16,4,4,4,4,2,2,2,4,4,4,4,2,2,16,4,4,4,4,2,2,2,2,2,2,2,4,16,4,4,4,4,2,2,2,2,2,2,2,4,16,4,4,4,4,16,16,16,16,16,16]
		duration = [x/1.8 for x in duration]
		self.playSong(song, duration)

	def playDarude(self):
		song = ['B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'E4', 'D4', 'D4', 'D4', 'D4', 'D4', 'D4', 'D4', 'A3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'E4', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'B3', 'E4']
		duration = [6] * len(song)
		self.playSong(song, duration)


	def playSong(self, notes, tempo=None):
		for i in range(len(notes)):
			if (tempo == None):
				self.playNote(self.freq[notes[i]])
			else:
				dur = 1000 / tempo[i] #note duration in seconds
				self.playNote(self.freq[notes[i]], dur)
		

	def playNote(self, note, duration=500):
	    if note:
	        self.brick.play_tone_and_wait(note, duration)
	    else:
	    	self.brick.play_tone_and_wait(0, duration)